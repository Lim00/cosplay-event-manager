// prisma/schema.prisma

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = "file:./dev.db"
}

// ì…ì¥ ë¡œê·¸ í…Œì´ë¸” (ì—‘ì…€ ì‹œíŠ¸ë¼ê³  ìƒê°í•˜ì„¸ìš”)
model EntryLog {
  id        Int      @id @default(autoincrement()) // ê³ ìœ  ë²ˆí˜¸
  visitor   String   // ë°©ë¬¸ì ì´ë¦„
  timestamp DateTime @default(now()) // ì…ì¥ ì‹œê°„
}

model User {
  id        Int     @id @default(autoincrement())
  email     String  @unique // ì•„ì´ë””ë¡œ ì‚¬ìš©
  password  String  // ì•”í˜¸í™”ëœ ë¹„ë°€ë²ˆí˜¸
  name      String?

  // ìœ ì €ê°€ ê°€ì§„ ìƒí’ˆë“¤ (1:N)
  goods    Goods[]
}

// ì¬ê³  ê´€ë¦¬ìš© ìƒí’ˆ ëª¨ë¸
model Goods {
  id        Int     @id @default(autoincrement())
  name      String  // ìƒí’ˆëª… (ì˜ˆ: ì•„í¬ë¦´ í‚¤ë§)
  price     Int     // ê°€ê²© 
  stock     Int     @default(0) // í˜„ì¬ ì¬ê³  (ê¸°ë³¸ê°’ 0)
  
  // [New] ì£¼ì¸ ì •ë³´ ì¶”ê°€
  ownerId   Int     // ëˆ„ê°€ ì£¼ì¸ì¸ì§€ (Foreign Key)
  owner     User    @relation(fields: [ownerId], references: [id])
  
  history   History[]   // ğŸ‘ˆ [New] 1:N ê´€ê³„ ì„¤ì • (í•˜ë‚˜ì˜ ìƒí’ˆì—” ì—¬ëŸ¬ ê¸°ë¡ì´ ìˆë‹¤)
}

// [New] ì…ì¶œê³  ê¸°ë¡ í…Œì´ë¸”
model History {
  id        Int     @id @default(autoincrement())
  goodsId   Int     // ì–´ë–¤ ìƒí’ˆì¸ê°€? (Foreign Key)
  change    Int     // ì–¼ë§ˆë§Œí¼ ë³€í–ˆë‚˜? (+1, -1, etc..)
  reason    String  // ì‚¬ìœ  (íŒë§¤, ì…ê³ , ë°˜í’ˆ ë“±)
  timestamp DateTime  @default(now())

  goods     Goods   @relation(fields: [goodsId], references: [id])
}